meta:
  name: "External API request [EXPERIMENTAL]."
  description: "
  POC example of an payload allowing external API requests.


  NOTE:

  This example is *experimental* and requires providers running yagna 0.12
  with a specific certificate chain added to their keystores.
  "
  author: "Golem Factory"
payloads:
  external-api-request:
    runtime: "vm/manifest"
    params:
      manifest: "ewogICJ2ZXJzaW9uIjogIjAuMS4wIiwKICAiY3JlYXRlZEF0IjogIjIwMjItMDctMjZUMTI6NTE6MDAuMDAwMDAwWiIsCiAgImV4cGlyZXNBdCI6ICIyMTAwLTAxLTAxVDAwOjAxOjAwLjAwMDAwMFoiLAogICJtZXRhZGF0YSI6IHsKICAgICJuYW1lIjogIkV4dGVybmFsIEFQSSBjYWxsIGV4YW1wbGUiLAogICAgImRlc2NyaXB0aW9uIjogIkV4YW1wbGUgbWFuaWZlc3Qgb2YgYSBzZXJ2aWNlIG1ha2luZyBhbiBvdXRib3VuZCBjYWxsIHRvIHRoZSBleHRlcm5hbCBBUEkiLAogICAgInZlcnNpb24iOiAiMC4xLjAiCiAgfSwKICAicGF5bG9hZCI6IFsKICAgIHsKICAgICAgInBsYXRmb3JtIjogewogICAgICAgICJhcmNoIjogIng4Nl82NCIsCiAgICAgICAgIm9zIjogImxpbnV4IgogICAgICB9LAogICAgICAidXJscyI6IFsKICAgICAgICAiaHR0cDovL3lhY24yLmRldi5nb2xlbS5uZXR3b3JrOjgwMDAvZG9ja2VyLWdvbGVtLXNjcmlwdC1jdXJsLWxhdGVzdC1kNzUyNjhlNzUyLmd2bWkiCiAgICAgIF0sCiAgICAgICJoYXNoIjogInNoYTM6ZTVmNWRkZmQ2NDk1MjVkYmUyNWQ5M2Q5ZWQ1MWQxYmRkMDg0OTkzM2Q5YTU3MjBhZGI0YjU4MTAiCiAgICB9CiAgXSwKICAiY29tcE1hbmlmZXN0IjogewogICAgInZlcnNpb24iOiAiMC4xLjAiLAogICAgInNjcmlwdCI6IHsKICAgICAgImNvbW1hbmRzIjogWwogICAgICAgICJydW4gLipjdXJsLioiLAogICAgICAgICJydW4gLipyZXF1ZXN0LnNoLioiLAogICAgICAgICJ0cmFuc2ZlciAuKm91dHB1dC50eHQiCiAgICAgIF0sCiAgICAgICJtYXRjaCI6ICJyZWdleCIKICAgIH0sCiAgICAibmV0IjogewogICAgICAiaW5ldCI6IHsKICAgICAgICAib3V0IjogewogICAgICAgICAgInByb3RvY29scyI6IFsiaHR0cHMiXSwKICAgICAgICAgICJ1cmxzIjogWyJodHRwczovL2FwaS5jb2luZ2Vja28uY29tIiwgImh0dHBzOi8vaHR0cGJpbi5vcmciXQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQo="
      # certificate used to sign the manifest will expire on Aug 7 14:09:25 2023 GMT
      manifest_cert: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUIvekNDQVlXZ0F3SUJBZ0lVTCtzbFdPYUN5cEMwK1ZaTTk2Vk1XM2xOM1Jrd0NnWUlLb1pJemowRUF3SXcKT0RFV01CUUdBMVVFQ2d3TlIyOXNaVzBnUm1GamRHOXllVEVlTUJ3R0ExVUVBd3dWUjI5c1pXMGdSbUZqZEc5eQplU0JTVDA5VUlFTkJNQjRYRFRJeU1URXlNekV4TkRBMU0xb1hEVEkxTVRFeU1qRXhOREExTTFvd1FERVdNQlFHCkExVUVDZ3dOUjI5c1pXMGdSbUZqZEc5eWVURW1NQ1FHQTFVRUF3d2RSMjlzWlcwZ1JtRmpkRzl5ZVNCSlRsUkYKVWsxRlJFbEJWRVVnUTBFd1dUQVRCZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFTU0Z2cFFkOVEwaEUzMwpWY2RXWHg1N0JOWWZ4TDgySWVjaEFoY09GWk1mdXhsVUloM3NjSXJ2VnU3SUtLLzVXWkVlTXczU2xVN3pRckhmCnhEUWhXN0ZabzJVd1l6QU9CZ05WSFE4QkFmOEVCQU1DQVFZd0VnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFUQTkKQmdOVkhSOEJBZjhFTXpBeE1DK2dMYUFyaGlsb2RIUndjem92TDJOaExtZHZiR1Z0TG01bGRIZHZjbXN2WTNKcwpMMGRQVEVWTkxVTkJMbU55YkRBS0JnZ3Foa2pPUFFRREFnTm9BREJsQWpBTXo2aXlIcXVkd1kwV3dmT0dTRVd1ClF0SisveDBFenRNekhWS0ljMXNGck5GaEtUbTFyTm96bFgxazVkR2FNWjBDTVFEckNjQ0JzOVhpVkNqUklqc0cKVXFTand5WEpwclNBUW40ZzNrRk5PTENIcnpPby81SVM5TVpVSDBsbmVrYmFhMW89Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNzekNDQWxxZ0F3SUJBZ0lVTkF0QmFNZG5iWWViN0gyQzZwZWdGRDhsVnA0d0NnWUlLb1pJemowRUF3SXcKUURFV01CUUdBMVVFQ2d3TlIyOXNaVzBnUm1GamRHOXllVEVtTUNRR0ExVUVBd3dkUjI5c1pXMGdSbUZqZEc5eQplU0JKVGxSRlVrMUZSRWxCVkVVZ1EwRXdIaGNOTWpNd05UQTVNVFF3T1RJMVdoY05Nak13T0RBM01UUXdPVEkxCldqQTRNUkV3RHdZRFZRUUREQWhGZUdGdGNHeGxjekVXTUJRR0ExVUVDZ3dOUjI5c1pXMGdSbUZqZEc5eWVURUwKTUFrR0ExVUVCaE1DVUV3d2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUNaMEFVcwpjVWhWMGlvNlRvbnhYTWhxbDlOb2k0cUN1WkFIc3dLTm5YMW1pTnd1bjErQUNpSWU0cGhDUTFUMXo5Q08wUDUwCndiMFEvM1p2Ulg2MzJYRkFvM0pkakpQdDRUOGQ5TzkwMGdjUjFnMStGd1RWWGtWUkNFWmMxMGFLd2FSTEpPbGcKSHFjVlJvTlVwblZNNnFlemd3d2h3ZFh3dERWRFVTUndrQStzcS91Zml6b1BObENIbnJSbDdpSWJZWjJwa052OQpOQXhDU3NIUXNWWEdpN3RpKzVpNkJDZkFFSlJObGRwRGovdlgrWEE4VWIwVDdlMFk4WE1lMk1IV3p1Yk1PZVU1ClJ2bTVGR3lvZU9QcGNrbTdBalc1YTdvbGxEZm5JZ1NsUnkvM05NZ1lwWkdTSVl3NzM4UlFSUllOemVIbVVaMDAKUDRmdml3OTZ3c2FqR0poWEFnTUJBQUdqYnpCdE1BNEdBMVVkRHdFQi93UUVBd0lCaGpBU0JnTlZIUk1CQWY4RQpDREFHQVFIL0FnRUJNRWNHQTFVZEh3RUIvd1E5TURzd09hQTNvRFdHTTJoMGRIQnpPaTh2WTJFdVoyOXNaVzB1CmJtVjBkMjl5YXk5amNtd3ZSMDlNUlUwdFNVNVVSVkpOUlVSSlFWUkZMbU55YkRBS0JnZ3Foa2pPUFFRREFnTkgKQURCRUFpQnplb1F1SVVTcFRKRXU0QmozRDhZZ1hWN0RsMVRlSjA5NUNiR1ZIWHVWRVFJZ0wyTFROUjBkTU5hNgpFOHU1eWpDYWIwTzVJU1YrY2dFbUdkMWhvTmlLLzRnPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=="
      manifest_sig: "HTA7cptuAMCvi4pz23Kt/CcycO5+UWbBDwod0j2fUbER/t+8NoFfVXNp5ZKK7e/DyIfjnmrLU26ZYfANHsbgTWA0VppJDg1shm1Z8r34NkeksPJ1FArrovtMtQzEaweWvUA5qVRLxgtcj0RhcYPzZLZ0uGbg7eGNKB9TWEjrENZF5RII8NJZCTnJ/lGVsr3h4we557W8YXgpGIu5wVCEY1yWahNPdmAmDVz+l1Suru+P94LLT3NVmtkhZR3zoI/XX9Inru0BfTeJid08VFLrgfJTE2rdmIzdHw29e/wziErQIGS2pPDhZAMk5c5I4GNtQpjcvXYuDt+5AuZ7+kPtkQ=="
      manifest_sig_algorithm: "sha256"
      capabilities:
        - inet
        - manifest-support
nodes:
  external-api-request:
    payload: "external-api-request"
    init:
      -
        - "/bin/sh"
        - "-c"
        - "GOLEM_PRICE=`curl --silent -X 'GET'
        'https://api.coingecko.com/api/v3/simple/price?ids=golem&vs_currencies=usd'
        -H 'accept: application/json' | jq .golem.usd`;
        echo \"Golem price: $GOLEM_PRICE USD\";
        "
