meta:
  name: "Weather Stats"
  description: "A minimal example of application getting current weather based on given location."
  author: "Golem Factory"
  version: "0.1.0"
payloads:
  cache:
    runtime: "vm"
    params:
      image_hash: "43ea70b47af16647473d1f9115be4deedd8dc3d3cf09e7a91807e2c9"
  api:
    runtime: "vm/manifest"
    params:
      capabilities:
        - inet
        - manifest-support
        - vpn
      # certificate used to sign the manifest will expire Thu Nov 23 19:49:21 CET 2023
      manifest: ewogICAgInZlcnNpb24iOiAiMC4xLjAiLAogICAgImNyZWF0ZWRBdCI6ICIyMDIyLTA3LTI2VDEyOjUxOjAwLjAwMDAwMFoiLAogICAgImV4cGlyZXNBdCI6ICIyMTAwLTAxLTAxVDAwOjAxOjAwLjAwMDAwMFoiLAogICAgIm1ldGFkYXRhIjogewogICAgICAgICJuYW1lIjogIldlYXRoZXIgU3RhdHMgQXBwIiwKICAgICAgICAiZGVzY3JpcHRpb24iOiAiQXBwbGljYXRpb24gdG8gZ2V0IFdlYXRoZXIsIHBvd2VyZWQgYnkgR29sZW0gTmV0d29yayIsCiAgICAgICAgInZlcnNpb24iOiAiMC4xLjAiCiAgICB9LAogICAgInBheWxvYWQiOiBbCiAgICAgICAgewogICAgICAgICAgICAicGxhdGZvcm0iOiB7CiAgICAgICAgICAgICAgICAiYXJjaCI6ICJ4ODZfNjQiLAogICAgICAgICAgICAgICAgIm9zIjogImxpbnV4IgogICAgICAgICAgICB9LAogICAgICAgICAgICAidXJscyI6IFsKICAgICAgICAgICAgICAgICJodHRwOi8veWFjbjIuZGV2LmdvbGVtLm5ldHdvcms6ODAwMC9kb2NrZXItd2VhdGhlcl9zdGF0cy1hcGktbGF0ZXN0LTAyN2RmZDZmNTEuZ3ZtaSIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgImhhc2giOiAic2hhMzo1MDU1MDlmY2U5OGJmYjkwNjcxMjUzMzRlNThhMzM0MDYxNWY4NjNhY2YyNThkNzI3NWNhMTI2NSIKICAgICAgICB9CiAgICBdLAogICAgImNvbXBNYW5pZmVzdCI6IHsKICAgICAgICAidmVyc2lvbiI6ICIwLjEuMCIsCiAgICAgICAgInNjcmlwdCI6IHsKICAgICAgICAgICAgImNvbW1hbmRzIjogWwogICAgICAgICAgICAgICAgInJ1biAuKnV2aWNvcm4uKiIKICAgICAgICAgICAgXSwKICAgICAgICAgICAgIm1hdGNoIjogInJlZ2V4IgogICAgICAgIH0sCiAgICAgICAgIm5ldCI6IHsKICAgICAgICAgICAgImluZXQiOiB7CiAgICAgICAgICAgICAgICAib3V0IjogewogICAgICAgICAgICAgICAgICAgICJwcm90b2NvbHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICJodHRwcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJodHRwIgogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgInVybHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICJodHRwOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZyIKICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0=
      manifest_cert: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUIvekNDQVlXZ0F3SUJBZ0lVTCtzbFdPYUN5cEMwK1ZaTTk2Vk1XM2xOM1Jrd0NnWUlLb1pJemowRUF3SXcKT0RFV01CUUdBMVVFQ2d3TlIyOXNaVzBnUm1GamRHOXllVEVlTUJ3R0ExVUVBd3dWUjI5c1pXMGdSbUZqZEc5eQplU0JTVDA5VUlFTkJNQjRYRFRJeU1URXlNekV4TkRBMU0xb1hEVEkxTVRFeU1qRXhOREExTTFvd1FERVdNQlFHCkExVUVDZ3dOUjI5c1pXMGdSbUZqZEc5eWVURW1NQ1FHQTFVRUF3d2RSMjlzWlcwZ1JtRmpkRzl5ZVNCSlRsUkYKVWsxRlJFbEJWRVVnUTBFd1dUQVRCZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFTU0Z2cFFkOVEwaEUzMwpWY2RXWHg1N0JOWWZ4TDgySWVjaEFoY09GWk1mdXhsVUloM3NjSXJ2VnU3SUtLLzVXWkVlTXczU2xVN3pRckhmCnhEUWhXN0ZabzJVd1l6QU9CZ05WSFE4QkFmOEVCQU1DQVFZd0VnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFUQTkKQmdOVkhSOEJBZjhFTXpBeE1DK2dMYUFyaGlsb2RIUndjem92TDJOaExtZHZiR1Z0TG01bGRIZHZjbXN2WTNKcwpMMGRQVEVWTkxVTkJMbU55YkRBS0JnZ3Foa2pPUFFRREFnTm9BREJsQWpBTXo2aXlIcXVkd1kwV3dmT0dTRVd1ClF0SisveDBFenRNekhWS0ljMXNGck5GaEtUbTFyTm96bFgxazVkR2FNWjBDTVFEckNjQ0JzOVhpVkNqUklqc0cKVXFTand5WEpwclNBUW40ZzNrRk5PTENIcnpPby81SVM5TVpVSDBsbmVrYmFhMW89Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMyakNDQW4rZ0F3SUJBZ0lVZldXWWRyTm0rRFZIbVcvR1QybzJYM0JvSUJZd0NnWUlLb1pJemowRUF3SXcKUURFV01CUUdBMVVFQ2d3TlIyOXNaVzBnUm1GamRHOXllVEVtTUNRR0ExVUVBd3dkUjI5c1pXMGdSbUZqZEc5eQplU0JKVGxSRlVrMUZSRWxCVkVVZ1EwRXdIaGNOTWpNd09ESTFNVGcwT1RJeFdoY05Nak14TVRJek1UZzBPVEl4CldqQmRNUnd3R2dZRFZRUUtEQk5IYjJ4bGJTQlRhRzkzWTJGelpTQlVaV0Z0TVJZd0ZBWURWUVFEREExVGFHOTMKWTJGelpTQlVaV0Z0TVNVd0l3WUpLb1pJaHZjTkFRa0JGaFpuY25wbFoyOXlla0JuYjJ4bGJTNXVaWFIzYjNKcgpNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXVwb1JqRUF5emU1by9CbUQ0ZlEyCjNxb2JNRi9vNVhEYjBoUTNaTy9SQUxmWlVyenF1YjI2My9RZ3l2TzdoS2NRZU10K3BoRk5HV1FHNmtDV2E5U0sKQ21ucW8xdWNZQU13eGYvTkV4Z2xlNjVYOGEwZS9hK0lYT1YzUklURnFHSllweWZzUUxkOWVSUkpOdVBDWTdRbQp5NlovMWtVYW5pMzhJMmt2bGdCVkMyL2tUSkJFckR0TjNFWkl0dXFDOGFHQ2paNnJ0VWdxbmw1dUV4d0MxaUNnCjh4WkZnMEhyYW10bS9PT2Z3b2d4bUdvbmM5bWVzTEQzc3E4V3hQMVMxbS8va1ZTa2hHNC9BYlJMV0JMZ0lQdk0KUEZ6WVZ2R0RvbnRPdmhnT2FXR3NOQmF0RGkvdnJMbkZ3dGtxbno2M2lTYXEvQW9QQURNcmYvRzBWVXorUHIzQgo0UUlEQVFBQm8yOHdiVEFPQmdOVkhROEJBZjhFQkFNQ0FZWXdFZ1lEVlIwVEFRSC9CQWd3QmdFQi93SUJBVEJICkJnTlZIUjhCQWY4RVBUQTdNRG1nTjZBMWhqTm9kSFJ3Y3pvdkwyTmhMbWR2YkdWdExtNWxkSGR2Y21zdlkzSnMKTDBkUFRFVk5MVWxPVkVWU1RVVkVTVUZVUlM1amNtd3dDZ1lJS29aSXpqMEVBd0lEU1FBd1JnSWhBTWNscnlkSgo4WTZMUGFHb3Q2SWwxYWxhYzBaM0Q4SU4zcC9RQ09XeGVYTnZBaUVBaGJkK3ppblMxc2lhc2t2aGNqazVtYkpDCjFNemFaakx6QUJlM2EvZWRvV0U9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
      manifest_sig: fc586b4MfSyeznFMV3bUcZ4IqnafduZP5Ur4wzgxRDrX/6GoCFEsRbo0Qs9xkTUbj3ieW3zFfg3mlahcOfc0rjfq5ChJYWHveZ8yzY3D1c38QrBYaYuCC1R1Wph9JaILx2EdSuVmgHlg1hl3FsyUHWq9AZBdgmAq2gIGVi/fsS88gSRwdf7iFarlTgAwyyrfB6Uu1SNg4cFawm9VRCiUwDKgsViDhBxnHjdqHFUwRxPi7tb1Be9PYtASVuIU0dTToywrpMXAQI9mBvzTbAYQhpjTpmzBnvHk9Gd61N4XUfFC0Bz6ySgR39KoOHucd++5xTdJ61xJpRGOxICjTPmurg==
      manifest_sig_algorithm: sha256
  app:
    runtime: "vm"
    params:
      image_hash: "5deb689ec435b6e4e64ef1af47706eee297ab67eeebbc26317d24253"
nodes:
  cache:
    payload: "cache"
    init:
      - [ "/bin/bash", "-c", "redis-server --bind 0.0.0.0 --requirepass eYVX7EwVmmxKPCDmwMtyKVge8oLd2t81 --loglevel debug > /dev/null &" ]
    network: "default"
    ip:
      - "192.168.0.2"
  api:
    payload: "api"
    init:
      - [ "/bin/bash", "-c", "uvicorn weather.app:app --host 192.168.0.3 --port 5053 &" ]
    network: "default"
    ip:
      - "192.168.0.3"
    depends_on:
      - "cache"
  app:
    payload: "app"
    init:
      - [ "/docker-entrypoint.sh" ]
      - [ "/bin/chmod", "a+x", "/" ]
      - [ "/usr/sbin/nginx" ]
    http_proxy:
      ports:
        - "80"
    network: "default"
    ip:
      - "192.168.0.4"
    depends_on:
      - "api"
networks:
  default:
    ip: "192.168.0.0/24"